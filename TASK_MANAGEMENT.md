# 牙齿分割与重建系统 - 任务管理文档

> **项目语言**: C++ (主要开发语言) + Python (辅助脚本)  
> **创建日期**: 2025-11-03  
> **状态图例**: ⬜️ 待开始 | 🔄 进行中 | ✅ 已完成 | ⚠️ 受阻

---

## 📋 目录
1. [牙颌预处理模块](#1-牙颌预处理模块)
2. [牙颌分割模块](#2-牙颌分割模块)
3. [牙齿重建模块（正畸设计）](#3-牙齿重建模块正畸设计)
4. [牙齿分析模块](#4-牙齿分析模块)
5. [输出模块](#5-输出模块)
6. [测试与验证](#6-测试与验证)

---

## 1. 牙颌预处理模块

### 1.1 自动调整颌平面
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配  
**算法类型**: 传统算法

#### 📝 描述
根据对模型最大边界的拟合（最小二乘或SVM等方法）确定Z方向，再根据模型的开口朝向、模型对称性等特征（PCA等方法）确定X和Y轴。

#### ✅ 待办清单
- [ ] **边界拟合模块** (C++)
  - [ ] 实现最小二乘拟合算法
  - [ ] 实现SVM边界拟合算法
  - [ ] 确定最大边界
  - [ ] 计算Z方向

- [ ] **坐标系确定** (C++)
  - [ ] 实现PCA主成分分析
  - [ ] 基于开口朝向确定坐标系
  - [ ] 基于对称性确定X和Y轴
  - [ ] 验证坐标系正确性

- [ ] **3D模型处理** (C++)
  - [ ] 加载3D牙齿模型
  - [ ] 模型预处理（去噪、归一化）
  - [ ] 边界提取

- [ ] **可视化与验证** (Python)
  - [ ] 坐标系可视化
  - [ ] 结果验证工具
  - [ ] 单元测试

#### 📦 依赖库
- Eigen (矩阵运算)
- PCL (点云处理)
- libsvm (SVM实现，可选)

---

### 1.2 手动调整颌平面
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: 交互操作

#### 📝 描述
无需特别算法，提供用户交互界面进行手动调整。

#### ✅ 待办清单
- [ ] **用户交互界面** (C++ with Qt)
  - [ ] 设计颌平面调整UI
  - [ ] 实现旋转/平移控制
  - [ ] 添加实时预览
  - [ ] 提供参考坐标轴显示

- [ ] **交互操作** (C++)
  - [ ] 鼠标拖拽旋转
  - [ ] 角度输入调整
  - [ ] 撤销/重做功能
  - [ ] 保存调整结果

---

### 1.3 模型数据飞边处理
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: 网格修复

#### 📝 描述
1、删除非连通的区域  
2、删除非流形边和点  
3、删除退化的点线面  
一轮可能不能完全删除，可以多次迭代。可以考虑使用vcglib或CGAL库实现。

#### ✅ 待办清单
- [ ] **连通域分析** (C++)
  - [ ] 实现连通域检测
  - [ ] 识别主连通区域
  - [ ] 删除非连通区域

- [ ] **流形修复** (C++)
  - [ ] 检测非流形边
  - [ ] 检测非流形点
  - [ ] 修复或删除非流形结构

- [ ] **退化检测与删除** (C++)
  - [ ] 检测退化点
  - [ ] 检测退化线
  - [ ] 检测退化面
  - [ ] 清理退化元素

- [ ] **迭代修复** (C++)
  - [ ] 实现迭代修复流程
  - [ ] 设置收敛条件
  - [ ] 性能优化

- [ ] **库集成** (C++)
  - [ ] 评估vcglib和CGAL
  - [ ] 选择并集成合适的库
  - [ ] 封装为统一接口

#### 📦 依赖库
- vcglib (可选)
- CGAL (可选)

---

### 1.4 气泡修复
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: Laplace平滑

#### 📝 描述
圈选气泡周围闭合边界，然后对边界内面元多次应用Laplace等平滑算法。

#### ✅ 待办清单
- [ ] **气泡检测** (C++)
  - [ ] 自动检测气泡区域
  - [ ] 或提供手动圈选工具
  - [ ] 提取闭合边界

- [ ] **Laplace平滑** (C++)
  - [ ] 实现Laplace平滑算子
  - [ ] 应用到边界内面元
  - [ ] 迭代平滑处理
  - [ ] 参数优化

- [ ] **边界保持** (C++)
  - [ ] 保持边界固定
  - [ ] 平滑过渡处理

- [ ] **质量验证** (Python)
  - [ ] 修复前后对比
  - [ ] 网格质量评估

---

### 1.5 凹陷修复
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: 类似气泡修复

#### 📝 描述
和气泡修复类似的处理方法。

#### ✅ 待办清单
- [ ] **凹陷检测** (C++)
  - [ ] 识别凹陷区域
  - [ ] 或提供手动圈选
  - [ ] 提取边界

- [ ] **平滑修复** (C++)
  - [ ] 应用Laplace平滑
  - [ ] 迭代处理
  - [ ] 保持边界

- [ ] **验证** (Python)
  - [ ] 修复效果可视化

---

## 2. 牙颌分割模块

### 2.1 牙颈线点画
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配  
**算法类型**: B样条插值 / Dijkstra最短路径

#### 📝 描述
圈选牙齿附近的多个特征点，特征点之间用B样条曲线插值，或者寻找特征点之间在曲面上的最短路径（Dijkstra最短路径法）。

#### ✅ 待办清单
- [ ] **特征点选择** (C++)
  - [ ] 实现手动点选工具
  - [ ] 存储特征点位置
  - [ ] 支持编辑和调整

- [ ] **B样条插值** (C++)
  - [ ] 实现B样条曲线插值
  - [ ] 连接相邻特征点
  - [ ] 生成平滑曲线

- [ ] **Dijkstra最短路径** (C++)
  - [ ] 在网格曲面上实现Dijkstra
  - [ ] 计算特征点间最短路径
  - [ ] 优化路径平滑度

- [ ] **方法对比** (C++)
  - [ ] 两种方法效果对比
  - [ ] 提供用户选择选项

- [ ] **可视化** (Python)
  - [ ] 特征点可视化
  - [ ] 牙颈线可视化
  - [ ] 交互调试工具

---

### 2.2 牙齿轮廓编辑
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: 交互编辑

#### 📝 描述
拖动上述的特征点，拖动的同时重新计算特征点之间的连接曲线。

#### ✅ 待办清单
- [ ] **交互编辑** (C++ with Qt)
  - [ ] 实现特征点拖拽
  - [ ] 实时更新连接曲线
  - [ ] 优化响应速度

- [ ] **曲线更新** (C++)
  - [ ] 实时重新计算B样条
  - [ ] 或实时更新最短路径
  - [ ] 保持曲线平滑

- [ ] **撤销重做** (C++)
  - [ ] 实现操作历史
  - [ ] 撤销/重做功能

---

### 2.3 牙齿编号
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: 无需特别算法

#### 📝 描述
无需特别算法，提供牙齿编号功能。

#### ✅ 待办清单
- [ ] **编号系统** (C++)
  - [ ] 实现FDI编号系统
  - [ ] 支持手动编号
  - [ ] 编号显示

- [ ] **数据管理** (C++)
  - [ ] 存储编号信息
  - [ ] 编号持久化

---

### 2.4 牙齿邻面识别和分割
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配  
**算法类型**: 见牙齿邻面重建(自动)

#### 📝 描述
识别和分割牙齿邻面，详见牙齿邻面重建(自动)任务。

#### ✅ 待办清单
- [ ] **邻面识别** (C++)
  - [ ] 识别相邻牙齿
  - [ ] 确定邻面区域

- [ ] **邻面分割** (C++)
  - [ ] 分割邻面网格
  - [ ] 标记邻面区域

（详细算法见3.3任务）

---

### 2.5 牙齿标志点标记
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: 无需特别算法

#### 📝 描述
无需特别算法，提供标志点标记功能。

#### ✅ 待办清单
- [ ] **标志点标记** (C++)
  - [ ] 定义标准标志点类型
  - [ ] 实现手动标记工具
  - [ ] 标志点显示

- [ ] **数据管理** (C++)
  - [ ] 存储标志点信息
  - [ ] 导入导出功能

---

### 2.6 自动牙齿识别和分割
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配  
**算法类型**: AI算法优先

#### 📝 描述
优先考虑AI算法。传统算法可以考虑根据每个点的曲率、法向等特征，进行迭代的聚类和区域增长和合并，类似层级聚类的算法，但会涉及一些参数的阈值设置，无法保证完全正确。如果有手动标记点，可以把点到标记点的测地距离作为特征加入，可以很大改善分割结果。

#### ✅ 待办清单
- [ ] **AI模型开发** (Python)
  - [ ] 准备训练数据集（标注的牙齿分割数据）
  - [ ] 选择深度学习框架（TensorFlow/PyTorch）
  - [ ] 设计分割网络（如PointNet++、MeshCNN等）
  - [ ] 训练模型
  - [ ] 模型验证和优化
  - [ ] 数据增强

- [ ] **传统算法备选** (C++)
  - [ ] 计算点的几何特征（曲率、法向）
  - [ ] 实现层级聚类算法
  - [ ] 区域增长和合并
  - [ ] 参数阈值调优
  - [ ] 集成手动标记点（测地距离特征）

- [ ] **模型部署** (C++)
  - [ ] ONNX模型转换
  - [ ] C++推理引擎集成
  - [ ] 性能优化

- [ ] **后处理** (C++)
  - [ ] 分割结果平滑
  - [ ] 错误修正
  - [ ] 边界优化

- [ ] **评估** (Python)
  - [ ] 分割精度评估
  - [ ] 方法对比
  - [ ] 可视化分析

---

### 2.7 自动牙齿编号
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: AI算法优先

#### 📝 描述
优先考虑AI算法。

#### ✅ 待办清单
- [ ] **AI编号模型** (Python)
  - [ ] 收集标注数据
  - [ ] 训练编号识别模型
  - [ ] 模型验证
  - [ ] 部署到C++

- [ ] **传统算法备选** (C++)
  - [ ] 基于位置规则的编号
  - [ ] 牙弓曲线分析
  - [ ] 对称性分析

---

## 3. 牙齿重建模块（正畸设计）

### 3.1 自动牙轴生成
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配  
**算法类型**: AI算法优先

#### 📝 描述
优先考虑AI算法。传统算法可以先计算唇舌侧特征点和近远中特征点（在底面投影上以牙弓方向为基准计算），再计算牙轴。

#### ✅ 待办清单
- [ ] **AI模型** (Python)
  - [ ] 准备牙轴标注数据
  - [ ] 训练牙轴预测模型
  - [ ] 模型验证
  - [ ] 部署到C++

- [ ] **传统算法** (C++)
  - [ ] 计算唇舌侧特征点
  - [ ] 计算近远中特征点
  - [ ] 底面投影处理
  - [ ] 基于牙弓方向计算牙轴
  - [ ] 牙轴优化

- [ ] **方法评估**
  - [ ] 两种方法对比
  - [ ] 精度评估

---

### 3.2 手动调整牙轴
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: 无需特别算法

#### 📝 描述
无需特别算法，提供手动调整功能。

#### ✅ 待办清单
- [ ] **交互工具** (C++ with Qt)
  - [ ] 牙轴旋转调整
  - [ ] 牙轴平移调整
  - [ ] 实时预览
  - [ ] 撤销重做

---

### 3.3 牙齿邻面重建(自动)
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配  
**算法类型**: 复杂几何算法

#### 📝 描述
1、先找到修补邻面在唇舌侧的特征点：根据相邻牙齿牙颈线点的邻接关系，设置一个最优化标准，比如综合考虑相邻特征点之间的直线距离、特征点到牙尖点的水平投影距离、特征点距离邻面最高点的高度等  
2、生成连接两个特征点的拟合曲线，作为邻面的底部边界  
3、生成邻面中的面元  
4、生成底部边界和邻面的时候，要考虑左右两侧牙齿之间的间隙和碰撞，因此生成过程可能需要迭代进行，直至达到目标的间隙或碰撞

#### ✅ 待办清单
- [ ] **特征点识别** (C++)
  - [ ] 分析牙颈线点邻接关系
  - [ ] 设计最优化标准
  - [ ] 计算直线距离
  - [ ] 计算到牙尖点的水平投影距离
  - [ ] 计算到邻面最高点的高度
  - [ ] 综合评估找到最优特征点

- [ ] **底部边界生成** (C++)
  - [ ] 实现曲线拟合算法
  - [ ] 连接唇舌侧特征点
  - [ ] 生成平滑边界曲线

- [ ] **邻面面元生成** (C++)
  - [ ] 生成邻面网格
  - [ ] 保持面元质量

- [ ] **间隙和碰撞处理** (C++)
  - [ ] 检测牙齿间间隙
  - [ ] 检测碰撞
  - [ ] 迭代调整生成过程
  - [ ] 达到目标间隙
  - [ ] 避免碰撞

- [ ] **迭代优化** (C++)
  - [ ] 设计迭代流程
  - [ ] 设置收敛条件
  - [ ] 性能优化

---

### 3.4 牙齿邻面重建(手动)
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: 半自动

#### 📝 描述
手动标记唇舌侧的邻面特征点，然后应用上述方法生成邻面底部边界和内部面元。边界和邻面的凹凸程度可手动调整。

#### ✅ 待办清单
- [ ] **手动标记** (C++ with Qt)
  - [ ] 特征点标记工具
  - [ ] 唇舌侧特征点选择

- [ ] **自动生成** (C++)
  - [ ] 调用自动邻面重建算法
  - [ ] 生成边界和面元

- [ ] **手动调整** (C++ with Qt)
  - [ ] 凹凸程度调整控件
  - [ ] 实时更新预览
  - [ ] 精细调整工具

---

### 3.5 牙冠修复和修整
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: CGAL补洞 + Laplace平滑

#### 📝 描述
主要包括圈选区域、删除、补洞、平滑等操作。补洞可以考虑CGAL库的补洞算法和refine算法。平滑使用Laplace一类的算法即可。

#### ✅ 待办清单
- [ ] **圈选工具** (C++ with Qt)
  - [ ] 区域圈选
  - [ ] 多种选择模式

- [ ] **删除操作** (C++)
  - [ ] 删除选中面元
  - [ ] 保持网格拓扑

- [ ] **补洞算法** (C++ with CGAL)
  - [ ] 集成CGAL补洞算法
  - [ ] 实现refine算法
  - [ ] 优化补洞质量

- [ ] **平滑操作** (C++)
  - [ ] Laplace平滑
  - [ ] 其他平滑算法
  - [ ] 迭代平滑

- [ ] **综合工具** (C++)
  - [ ] 统一操作接口
  - [ ] 撤销重做
  - [ ] 预览功能

#### 📦 依赖库
- CGAL

---

### 3.6 虚拟牙龈重建
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配  
**算法类型**: 复杂几何重建

#### 📝 描述
1、计算每个牙齿的一些特征点：唇舌侧点、近远中点、牙龈搭桥点、牙齿中心点等  
2、确定牙龈底部平面  
3、拟合唇舌侧牙弓和中心牙弓在底部的投影采样点  
4、根据牙弓和特征点计算牙龈底部边界点  
5、确定每颗牙齿唇舌侧的牙颈线采样点  
6、拟合所有牙齿牙颈线形成闭合的环路  
7、在牙颈线和底部边界之间生成牙龈侧面面元，可使用B样条曲线/曲面或其他方式  
8、补全牙齿间未连接的部分  
9、平滑

#### ✅ 待办清单
- [ ] **特征点计算** (C++)
  - [ ] 计算唇舌侧点
  - [ ] 计算近远中点
  - [ ] 计算牙龈搭桥点
  - [ ] 计算牙齿中心点

- [ ] **底部平面确定** (C++)
  - [ ] 计算牙龈底部平面
  - [ ] 平面优化

- [ ] **牙弓拟合** (C++)
  - [ ] 拟合唇舌侧牙弓
  - [ ] 拟合中心牙弓
  - [ ] 底部投影采样

- [ ] **底部边界计算** (C++)
  - [ ] 基于牙弓和特征点计算边界
  - [ ] 优化边界点位置

- [ ] **牙颈线处理** (C++)
  - [ ] 确定牙颈线采样点
  - [ ] 拟合所有牙齿牙颈线
  - [ ] 形成闭合环路

- [ ] **侧面面元生成** (C++)
  - [ ] B样条曲线/曲面生成
  - [ ] 在牙颈线和底部边界间生成面元
  - [ ] 优化面元质量

- [ ] **补全连接** (C++)
  - [ ] 识别未连接部分
  - [ ] 补全牙齿间连接
  - [ ] 保持连续性

- [ ] **平滑处理** (C++)
  - [ ] 整体平滑
  - [ ] 细节优化

---

### 3.7 牙根模拟
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: AI算法（真实牙根）/ 几何算法（虚拟牙根）

#### 📝 描述
真实牙根模拟需要考虑AI算法。虚拟牙根则只需要找到牙冠和牙根的边界，对中间部分先搭桥连接，然后应用补洞算法，最后对孔洞进行refine和平滑即可。

#### ✅ 待办清单
- [ ] **真实牙根模拟** (Python + C++)
  - [ ] 准备牙根数据集
  - [ ] 训练牙根生成模型
  - [ ] 部署到C++

- [ ] **虚拟牙根生成** (C++)
  - [ ] 识别牙冠和牙根边界
  - [ ] 搭桥连接
  - [ ] 应用补洞算法
  - [ ] refine处理
  - [ ] 平滑优化

- [ ] **方法选择**
  - [ ] 根据需求选择方法
  - [ ] 提供切换选项

---

## 4. 牙齿分析模块

### 4.1 牙齿特征点识别
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配  
**算法类型**: AI算法优先

#### 📝 描述
优先考虑AI算法识别牙齿特征点。

#### ✅ 待办清单
- [ ] **AI模型** (Python)
  - [ ] 准备特征点标注数据
  - [ ] 训练特征点检测模型
  - [ ] 模型验证
  - [ ] 部署到C++

- [ ] **传统算法备选** (C++)
  - [ ] 基于几何特征检测
  - [ ] 曲率分析
  - [ ] 关键点提取

---

### 4.2 邻面去釉模拟
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: 待定

#### 📝 描述
模拟邻面去釉操作。

#### ✅ 待办清单
- [ ] **去釉区域选择** (C++)
  - [ ] 邻面识别
  - [ ] 去釉区域标记

- [ ] **去釉模拟** (C++)
  - [ ] 网格修改算法
  - [ ] 厚度控制
  - [ ] 平滑处理

- [ ] **可视化** (Python)
  - [ ] 去釉前后对比
  - [ ] 厚度热图

---

### 4.3 虚拟牙龈随动
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配  
**算法类型**: Morph动画 + 骨骼动画

#### 📝 描述
根据牙齿分步矩阵，挑选一些中间关键步骤，分别生成这些步骤对应的牙龈模型，然后使用Morph动画生成其他步骤的动画；如果需要实时调整牙齿牙龈随动，需要以每个牙齿为骨骼，分配每个牙龈点到相邻骨骼的权重，并应用骨骼动画。

#### ✅ 待办清单
- [ ] **关键步骤选择** (C++)
  - [ ] 分析牙齿分步矩阵
  - [ ] 挑选关键步骤
  - [ ] 生成关键步骤牙龈模型

- [ ] **Morph动画** (C++)
  - [ ] 实现Morph动画生成
  - [ ] 关键帧插值
  - [ ] 生成中间步骤动画

- [ ] **骨骼动画** (C++)
  - [ ] 每个牙齿作为骨骼
  - [ ] 计算牙龈点到骨骼的权重
  - [ ] 实现骨骼动画
  - [ ] 实时随动更新

- [ ] **性能优化** (C++)
  - [ ] 优化动画计算
  - [ ] 实时渲染优化

---

### 4.4 牙弓曲线/宽度识别计算
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配  
**算法类型**: B样条曲线

#### 📝 描述
已经有特征点的情况下，使用B样条曲线连接即可。

#### ✅ 待办清单
- [ ] **特征点提取** (C++)
  - [ ] 提取牙弓特征点
  - [ ] 排序和筛选

- [ ] **B样条拟合** (C++)
  - [ ] 实现B样条曲线拟合
  - [ ] 连接特征点
  - [ ] 优化曲线平滑度

- [ ] **宽度计算** (C++)
  - [ ] 计算牙弓宽度
  - [ ] 多个位置测量
  - [ ] 生成报告

---

### 4.5 Spee曲线识别计算
**状态**: ⬜️ 待开始  
**优先级**: 🟢 低  
**负责人**: 待分配  
**算法类型**: 待定

#### 📝 描述
识别和计算Spee曲线。

#### ✅ 待办清单
- [ ] **Spee曲线定义** (C++)
  - [ ] 定义Spee曲线
  - [ ] 特征点选择

- [ ] **曲线拟合** (C++)
  - [ ] 拟合Spee曲线
  - [ ] 计算曲线参数

---

### 4.6 安氏分类识别分析
**状态**: ⬜️ 待开始  
**优先级**: 🟢 低  
**负责人**: 待分配  
**算法类型**: 待定

#### 📝 描述
进行安氏分类识别和分析。

#### ✅ 待办清单
- [ ] **特征提取** (C++)
  - [ ] 提取分类相关特征
  - [ ] 测量关键参数

- [ ] **分类算法** (C++ / Python)
  - [ ] 实现分类规则
  - [ ] 或训练分类模型

- [ ] **报告生成** (Python)
  - [ ] 生成分析报告
  - [ ] 可视化展示

---

### 4.7 覆合覆盖识别分析
**状态**: ⬜️ 待开始  
**优先级**: 🟢 低  
**负责人**: 待分配  
**算法类型**: 待定

#### 📝 描述
识别和分析覆合覆盖情况。

#### ✅ 待办清单
- [ ] **覆合检测** (C++)
  - [ ] 上下颌位置分析
  - [ ] 计算覆合度

- [ ] **覆盖检测** (C++)
  - [ ] 计算覆盖量
  - [ ] 识别异常情况

- [ ] **分析报告** (Python)
  - [ ] 生成分析报告
  - [ ] 可视化

---

## 5. 输出模块

### 5.1 三维牙齿mesh输出
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配

#### 📝 描述
输出处理后的三维牙齿mesh模型。

#### ✅ 待办清单
- [ ] **格式支持** (C++)
  - [ ] STL格式输出
  - [ ] OBJ格式输出
  - [ ] PLY格式输出
  - [ ] OFF格式输出

- [ ] **质量控制** (C++)
  - [ ] 网格质量检查
  - [ ] 法向一致性验证
  - [ ] 闭合性检查
  - [ ] 拓扑检查

- [ ] **元数据** (C++)
  - [ ] 包含牙齿编号
  - [ ] 包含特征点
  - [ ] 包含标注信息

- [ ] **批量输出** (Python)
  - [ ] 批量导出脚本
  - [ ] 格式转换工具

---

### 5.2 三维牙齿带牙龈mesh输出
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配

#### 📝 描述
输出包含牙龈的完整三维模型。

#### ✅ 待办清单
- [ ] **合并模型** (C++)
  - [ ] 合并牙齿和牙龈网格
  - [ ] 保持边界连续性
  - [ ] 多材质支持

- [ ] **输出格式** (C++)
  - [ ] 支持多种格式
  - [ ] 材质信息导出
  - [ ] 分层信息保留

- [ ] **验证** (Python)
  - [ ] 输出文件验证
  - [ ] 可视化检查

---

## 6. 测试与验证

### 6.1 单元测试
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配

#### 📝 描述
为所有核心模块编写单元测试。

#### ✅ 待办清单
- [ ] **C++测试框架**
  - [ ] 集成Google Test
  - [ ] 为每个算法模块编写测试
  - [ ] 边界条件测试
  - [ ] 性能测试
  - [ ] 设置CI/CD

- [ ] **Python测试**
  - [ ] 使用pytest
  - [ ] AI模型测试
  - [ ] 辅助脚本测试
  - [ ] 覆盖率统计

---

### 6.2 集成测试
**状态**: ⬜️ 待开始  
**优先级**: 🔴 高  
**负责人**: 待分配

#### 📝 描述
测试各模块间的集成和完整流程。

#### ✅ 待办清单
- [ ] **端到端测试** (C++ & Python)
  - [ ] 完整工作流测试
  - [ ] 数据流验证
  - [ ] 接口测试

- [ ] **性能测试**
  - [ ] 基准测试
  - [ ] 压力测试
  - [ ] 内存测试

- [ ] **用户场景测试**
  - [ ] 常见使用场景
  - [ ] 边界情况
  - [ ] 异常处理

---

### 6.3 用户验收测试
**状态**: ⬜️ 待开始  
**优先级**: 🟡 中  
**负责人**: 待分配

#### 📝 描述
与用户进行验收测试，确保满足需求。

#### ✅ 待办清单
- [ ] **测试用例设计**
  - [ ] 设计测试用例
  - [ ] 准备测试数据
  - [ ] 制定验收标准

- [ ] **用户测试**
  - [ ] 用户培训
  - [ ] 收集反馈
  - [ ] 问题记录

- [ ] **优化改进**
  - [ ] 根据反馈优化
  - [ ] 文档完善

---

## 📊 项目进度总览

| 模块 | 子任务数 | 已完成 | 进行中 | 待开始 | 完成率 |
|------|---------|--------|--------|--------|--------|
| 1. 牙颌预处理 | 5 | 0 | 0 | 5 | 0% |
| 2. 牙颌分割 | 7 | 0 | 0 | 7 | 0% |
| 3. 牙齿重建（正畸设计） | 7 | 0 | 0 | 7 | 0% |
| 4. 牙齿分析 | 7 | 0 | 0 | 7 | 0% |
| 5. 输出模块 | 2 | 0 | 0 | 2 | 0% |
| 6. 测试与验证 | 3 | 0 | 0 | 3 | 0% |
| **总计** | **31** | **0** | **0** | **31** | **0%** |

---

## 🛠️ 技术栈

### C++ 核心库
- **Eigen**: 矩阵运算和线性代数
- **PCL (Point Cloud Library)**: 点云处理
- **CGAL**: 计算几何算法库（补洞、refine）
- **vcglib**: 网格处理（可选）
- **VTK**: 可视化工具包
- **Qt**: GUI界面
- **OpenMP**: 多线程并行
- **libsvm**: 支持向量机（可选）
- **ONNX Runtime**: AI模型推理

### Python 辅助工具
- **NumPy/SciPy**: 数值计算
- **Matplotlib/Plotly**: 数据可视化
- **Open3D**: 3D数据处理和可视化
- **TensorFlow/PyTorch**: 深度学习框架
- **ONNX**: 模型转换
- **scikit-learn**: 机器学习
- **pytest**: 单元测试
- **trimesh**: 网格处理

### 深度学习模型
- **PointNet++**: 点云分割
- **MeshCNN**: 网格分割
- **PointNet**: 特征点检测
- **自定义模型**: 牙齿编号、牙轴生成、牙根模拟等

### 构建和部署
- **CMake**: 跨平台构建
- **Git**: 版本控制
- **Docker**: 容器化部署
- **Jenkins/GitHub Actions**: CI/CD

---

## 📝 开发规范

### 代码风格
- **C++**: Google C++ Style Guide
- **Python**: PEP 8
- **格式化工具**: clang-format (C++), black (Python)
- **注释规范**: Doxygen (C++), docstring (Python)

### Git工作流
- **主分支**: `main` (稳定版本)
- **开发分支**: `develop` (开发版本)
- **功能分支**: `feature/[module]-[description]`
  - 例如: `feature/preprocessing-auto-adjust-plane`
- **修复分支**: `fix/[issue-description]`
- **提交格式**: `[模块名] 简短描述`
  - 例如: `[牙颌预处理] 实现最小二乘边界拟合算法`

### 代码审查
- 所有代码必须经过Code Review
- 至少一人审查通过才能合并
- 使用Pull Request进行代码审查

### 文档要求
- 每个模块需要README
- 函数/类需要详细注释
- 算法需要文档说明
- 维护CHANGELOG

---

## 📚 任务依赖关系

### 关键路径
1. **基础设施** → **牙颌预处理** → **牙颌分割** → **牙齿重建** → **牙齿分析** → **输出**

### 具体依赖
- **自动牙齿识别和分割** (2.6) 是很多任务的基础
- **牙颈线点画** (2.1) 是 **牙齿邻面重建** (3.3) 的前置任务
- **虚拟牙龈重建** (3.6) 依赖于 **牙颌分割** 的结果
- **虚拟牙龈随动** (4.3) 依赖于 **虚拟牙龈重建** (3.6)

---

## 🎯 优先级和里程碑

### 第一阶段（Month 1-2）：基础框架和预处理
**目标**: 搭建项目框架，完成牙颌预处理模块

- [ ] 项目框架搭建
- [ ] 集成核心库（Eigen, PCL, CGAL, Qt等）
- [ ] 1.1 自动调整颌平面 🔴
- [ ] 1.2 手动调整颌平面 🟡
- [ ] 1.3 模型数据飞边处理 🟡
- [ ] 1.4 气泡修复 🟡
- [ ] 1.5 凹陷修复 🟡
- [ ] 单元测试框架

### 第二阶段（Month 3-4）：牙颌分割
**目标**: 完成牙颌分割功能，特别是AI自动分割

- [ ] 2.1 牙颈线点画 🔴
- [ ] 2.2 牙齿轮廓编辑 🟡
- [ ] 2.3 牙齿编号 🟡
- [ ] 2.4 牙齿邻面识别和分割 🔴
- [ ] 2.5 牙齿标志点标记 🟡
- [ ] 2.6 自动牙齿识别和分割 🔴（重点，需要AI模型）
- [ ] 2.7 自动牙齿编号 🟡（AI模型）

### 第三阶段（Month 5-7）：牙齿重建
**目标**: 完成正畸设计相关功能

- [ ] 3.1 自动牙轴生成 🔴（AI模型）
- [ ] 3.2 手动调整牙轴 🟡
- [ ] 3.3 牙齿邻面重建(自动) 🔴（复杂算法）
- [ ] 3.4 牙齿邻面重建(手动) 🟡
- [ ] 3.5 牙冠修复和修整 🟡
- [ ] 3.6 虚拟牙龈重建 🔴（复杂算法）
- [ ] 3.7 牙根模拟 🟡（AI模型 + 几何算法）

### 第四阶段（Month 8-9）：牙齿分析和输出
**目标**: 完成分析功能和输出模块

- [ ] 4.1 牙齿特征点识别 🔴（AI模型）
- [ ] 4.2 邻面去釉模拟 🟡
- [ ] 4.3 虚拟牙龈随动 🔴（动画算法）
- [ ] 4.4 牙弓曲线/宽度识别计算 🟡
- [ ] 4.5 Spee曲线识别计算 🟢
- [ ] 4.6 安氏分类识别分析 🟢
- [ ] 4.7 覆合覆盖识别分析 🟢
- [ ] 5.1 三维牙齿mesh输出 🔴
- [ ] 5.2 三维牙齿带牙龈mesh输出 🔴

### 第五阶段（Month 10）：集成测试和优化
**目标**: 完整系统集成、测试和优化

- [ ] 6.1 单元测试完善 🔴
- [ ] 6.2 集成测试 🔴
- [ ] 6.3 用户验收测试 🟡
- [ ] 性能优化
- [ ] 文档完善
- [ ] Bug修复

---

## 🔬 研究和技术难点

### AI模型需求
以下任务需要训练深度学习模型：
1. **自动牙齿识别和分割** (2.6) - 最重要
2. **自动牙齿编号** (2.7)
3. **自动牙轴生成** (3.1)
4. **牙根模拟** (3.7) - 真实牙根
5. **牙齿特征点识别** (4.1)

**需要准备的数据集**：
- 牙齿分割标注数据（最关键）
- 牙齿编号标注数据
- 牙轴标注数据
- 牙根CT数据
- 特征点标注数据

### 算法难点
1. **牙齿邻面重建(自动)** (3.3) - 复杂的几何优化问题
2. **虚拟牙龈重建** (3.6) - 复杂的曲面重建
3. **虚拟牙龈随动** (4.3) - 动画和变形算法

### 性能优化点
- 大规模网格处理优化
- AI模型推理加速
- 实时交互响应优化
- 并行计算优化

---

## 📞 团队角色

### 建议团队结构
- **项目负责人** (1人): 整体协调
- **C++开发工程师** (2-3人): 核心算法实现
- **AI工程师** (1-2人): 深度学习模型
- **前端/UI工程师** (1人): Qt界面开发
- **测试工程师** (1人): 测试和质量保证
- **算法研究员** (1人): 复杂算法研究（邻面重建、牙龈重建等）

---

## 📖 参考资源

### 论文和算法
- PointNet++: Deep Hierarchical Feature Learning on Point Sets
- MeshCNN: A Network with an Edge
- Dijkstra最短路径算法
- B样条曲线和曲面
- Laplace平滑算法
- CGAL库文档

### 开源项目
- Open3D
- trimesh
- PyMeshLab
- MeshLab

### 数据集
- 3D牙齿扫描数据集（需要收集）
- CT牙根数据（用于牙根模拟）

---

## 📌 备注

1. **AI优先策略**: 对于复杂的识别和分类任务，优先考虑AI算法，传统算法作为备选
2. **迭代开发**: 复杂算法采用迭代优化策略
3. **用户反馈**: 定期收集用户反馈，及时调整
4. **文档同步**: 代码和文档同步更新
5. **代码质量**: 严格代码审查，保证质量

---

**文档版本**: v1.0  
**最后更新**: 2025-11-03  
**维护者**: 开发团队

---

**更新日志**:
- 2025-11-03: 初始版本，根据原始需求文档创建
